import os
import re

# Prompt user for operational details
network = input("Target hostname, IP address, or network: ")
site = input("Target site name: ")


### Host Discovery
os.system(f"sudo nmap -sn {network} -oG {site}_hscan")
os.system(f"cat {site}_hscan | cut -d' ' -f 2 | grep -v Nmap | sort -u > {site}_hostlist")

### TCP / UDP / SCTP Scanning
#os.system(f"sudo nmap -Pn  -sU -sS -sY --max-rtt-timeout 500ms --max-retries 5 --min-hostgroup 256 --randomize-hosts --spoof-mac cisco --stats-every 60 --open -iL {site}_hostlist --oG {site}_pscan")

### OS / Service / Vulnerability Scanning
## Takes longer when provided specific ports due to nature of OS scanning

os.system(f"sudo nmap -Pn -A --script vulners --max-rtt-timeout 1500ms --max-retries 5 --min-hostgroup 256 --randomize-hosts --stats-every 60 -iL {site}_hostlist -oG {site}_osvscan")
